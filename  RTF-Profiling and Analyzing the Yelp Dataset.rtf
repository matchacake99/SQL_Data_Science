{\rtf1\ansi\ansicpg1252\cocoartf2580
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fmodern\fcharset0 Courier-Bold;\f1\fmodern\fcharset0 Courier;\f2\fnil\fcharset0 Menlo-Regular;
\f3\fnil\fcharset0 Monaco;}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;\red133\green26\blue2;\red0\green0\blue255;
\red255\green255\blue254;\red100\green117\blue135;\red251\green0\blue255;\red38\green38\blue38;\red255\green255\blue255;
\red255\green255\blue254;\red100\green117\blue135;\red251\green0\blue7;\red19\green118\blue70;\red0\green0\blue0;
}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0;\cssrgb\c59786\c15759\c0;\cssrgb\c0\c0\c100000;
\cssrgb\c100000\c100000\c99608;\cssrgb\c46667\c53333\c60000;\cssrgb\c100000\c0\c100000;\cssrgb\c20000\c20000\c20000;\cssrgb\c100000\c100000\c100000;
\cssrgb\c100000\c100000\c99608;\cssrgb\c46667\c53333\c60000;\cssrgb\c100000\c0\c0;\cssrgb\c3529\c52549\c34510;\cssrgb\c0\c1\c1;
}
\paperw11900\paperh16840\margl1440\margr1440\vieww10820\viewh14700\viewkind0
\deftab720
\pard\pardeftab720\partightenfactor0

\f0\b\fs32 \cf2 \expnd0\expndtw0\kerning0
Data Scientist Role Play: Profiling and Analyzing the Yelp Dataset 
\f1\b0\fs24 \
\

\f0\b Xiuyu Chen
\f1\b0 \
\

\f0\b Part 1: Yelp Dataset Profiling and Understanding
\f1\b0 \
\
\cf3 1. Profile the data by finding the total number of records for each of the tables below:\cf2 \
	\
i. Attribute table   = 10000\
ii. Business table   = 10000\
iii. Category table  = 10000\
iv. Checkin table    = 10000\
v. elite_years table = 10000\
vi. friend table     = 10000\
vii. hours table     = 10000\
viii. photo table    = 10000\
ix. review table     = 10000\
x. tip table         = 10000\
xi. user table       = 10000\
	\
************SQL CODE************\
\pard\pardeftab720\sl360\partightenfactor0

\f2 \cf4 \cb5 SELECT\cf2  \cf6 *\cf2 \cb1 \
\cf4 \cb5 FROM\cf2  table;\
\pard\pardeftab720\partightenfactor0

\f1 \cf2 \cb1 ********************************\
\
\cf3 2. Find the total distinct records by either the foreign key or primary key for each table. If two foreign keys are listed in the table, please specify which foreign key.\cf2 \
\
i. Business     = 10000(id)\
ii. Hours       = 1562(business_id)\
iii. Category   = 2643(business id)\
iv. Attribute   = 1115(business_id)\
v. Review       = 10000(id)\
vi. Checkin     = 493(business_id)\
vii. Photo      = 10000(id)\
viii. Tip       = 537(user_id) or 3979(business_id)\
ix. User        = 10000(id)\
x. Friend       = 11(user_id)\
xi. Elite_years = 2780(user_id)\
\
Note: Primary Keys are denoted in the ER-Diagram with a yellow key icon.	\
\
************SQL CODE************\
\pard\pardeftab720\sl360\partightenfactor0

\f2 \cf4 \cb5 SELECT\cf2  \cf4 DISTINCT\cf2  key\cb1 \
\cf4 \cb5 FROM\cf2  table;\cb1 \
\pard\pardeftab720\partightenfactor0

\f1 \cf2 ********************************\
\
\cf3 3. Are there any columns with null values in the Users table? Indicate "yes," or "no."\cf2 \
\
Answer: no\
	\
	\
SQL code used to arrive at answer: 
\f2 \cf4 \cb5 \
\pard\pardeftab720\sl360\partightenfactor0
\cf4 SELECT\cf2  \cf6 *\cf2 \cb1 \
\cf4 \cb5 FROM\cf2  \cf4 user\cf2 \cb1 \
\cf4 \cb5 WHERE\cf2  id \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  \cf4 name\cf2  \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  review_count \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  yelping_since \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  useful \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  funny \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  cool \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  fans \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  average_stars \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  compliment_hot \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  compliment_more \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  compliment_profile \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  compliment_cute \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  compliment_list \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  compliment_note \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  compliment_plain \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  compliment_cool \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  compliment_funny \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  compliment_writer \cf6 IS\cf2  \cf6 NULL\cf2 \cb1 \
\cb5     \cf6 OR\cf2  compliment_photos \cf6 IS\cf2  \cf6 NULL\cf2 ;\cb1 \
\pard\pardeftab720\fi1289\partightenfactor0

\f1 \cf2 	\
\pard\pardeftab720\partightenfactor0
\cf2 \
	\
\cf3 4. For each table and column listed below, display the smallest (minimum), largest (maximum), and average (mean) value for the following fields:\cf2 \
\
	i. Table: Review, Column: Stars\
	\
		min:	1	max:	5	avg: 3.7082\
		\
	\
	ii. Table: Business, Column: Stars\
	\
		min:	1.0	max:	5.0	avg: 3.6549\
		\
	\
	iii. Table: Tip, Column: Likes\
	\
		min:	0	max:	2	avg: 0.0144\
		\
	\
	iv. Table: Checkin, Column: Count\
	\
		min:	1	max:	53	avg: 1.9414\
		\
	\
	v. Table: User, Column: Review_count\
	\
		min:	0	max:	2000	avg: 24.2995\
		\
************SQL CODE************\
\pard\pardeftab720\sl360\partightenfactor0

\f2 \cf4 \cb5 SELECT\cf2  \cf7 MIN\cf2 (column), \cf7 MAX\cf2 (column), \cf7 AVG\cf2 (column)\cb1 \
\cf4 \cb5 FROM\cf2  table;\cb1 \
\pard\pardeftab720\partightenfactor0

\f1 \cf2 ********************************\
\
\cf3 5. List the cities with the most reviews in descending order:\cf2 \
\
SQL code used to arrive at answer:\
\pard\pardeftab720\sl360\partightenfactor0

\f2 \cf4 \cb5 SELECT\cf2  city, \cf7 SUM\cf2 (review_count) \cf4 AS\cf2  NReviews\cb1 \
\cf4 \cb5 FROM\cf2  business\cb1 \
\cf4 \cb5 GROUP\cf2  \cf4 BY\cf2  city\cb1 \
\cf4 \cb5 ORDER\cf2  \cf4 BY\cf2  NReviews \cf4 DESC\cf2 ;\cb1 \
\pard\pardeftab720\partightenfactor0

\f1 \cf2 	\
	\
Copy and Paste the Result Below:\
\pard\pardeftab720\partightenfactor0

\f3\fs28 \cf8 \cb9 +-----------------+----------+\
| city            | NReviews |\
+-----------------+----------+\
| Las Vegas       |    82854 |\
| Phoenix         |    34503 |\
| Toronto         |    24113 |\
| Scottsdale      |    20614 |\
| Charlotte       |    12523 |\
| Henderson       |    10871 |\
| Tempe           |    10504 |\
| Pittsburgh      |     9798 |\
| Montr\'e9al        |     9448 |\
| Chandler        |     8112 |\
| Mesa            |     6875 |\
| Gilbert         |     6380 |\
| Cleveland       |     5593 |\
| Madison         |     5265 |\
| Glendale        |     4406 |\
| Mississauga     |     3814 |\
| Edinburgh       |     2792 |\
| Peoria          |     2624 |\
| North Las Vegas |     2438 |\
| Markham         |     2352 |\
| Champaign       |     2029 |\
| Stuttgart       |     1849 |\
| Surprise        |     1520 |\
| Lakewood        |     1465 |\
| Goodyear        |     1155 |\
+-----------------+----------+\
(Output limit exceeded, 25 of 362 total rows shown)
\f1\fs24 \cf2 \cb1 \
	\
\pard\pardeftab720\partightenfactor0
\cf3 6. Find the distribution of star ratings to the business in the following cities:\cf2 \
\
i. Avon\
\
\pard\pardeftab720\sl360\partightenfactor0

\f2 \cf4 \cb10 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec4 SELECT\cf2 \strokec2  stars \cf4 \strokec4 AS\cf2 \strokec2  [star rating]\cb1 \
\cb10 , \cf7 \strokec7 COUNT\cf2 \strokec2 (stars) \cf4 \strokec4 AS\cf2 \strokec2  \cf7 \strokec7 count\cf2 \cb1 \strokec2 \
\cf4 \cb10 \strokec4 FROM\cf2 \strokec2  business\cb1 \
\cf4 \cb10 \strokec4 WHERE\cf2 \strokec2  city \cf11 \strokec11 =\cf2 \strokec2  \cf12 \strokec12 'Avon'\cf2 \cb1 \strokec2 \
\cf4 \cb10 \strokec4 GROUP\cf2 \strokec2  \cf4 \strokec4 BY\cf2 \strokec2  stars;\cb1 \
\pard\pardeftab720\sl360\partightenfactor0
\cf2 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \
\pard\pardeftab720\partightenfactor0

\f1 \cf2 \
Copy and Paste the Resulting Table Below (2 columns - star rating and count):\
\pard\pardeftab720\partightenfactor0

\f3\fs28 \cf8 \cb9 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec8 +-------------+-------+\
| star rating | count |\
+-------------+-------+\
|         1.5 |     1 |\
|         2.5 |     2 |\
|         3.5 |     3 |\
|         4.0 |     2 |\
|         4.5 |     1 |\
|         5.0 |     1 |\
+-------------+-------+
\f1\fs24 \cf2 \cb1 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \
\pard\pardeftab720\partightenfactor0
\cf2 \
ii. Beachwood\
\
SQL code used to arrive at answer:\
\pard\pardeftab720\sl360\partightenfactor0

\f2 \cf4 \cb10 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec4 SELECT\cf2 \strokec2  stars \cf4 \strokec4 AS\cf2 \strokec2  [star rating]\cb1 \
\cb10 , \cf7 \strokec7 COUNT\cf2 \strokec2 (stars) \cf4 \strokec4 AS\cf2 \strokec2  \cf7 \strokec7 count\cf2 \cb1 \strokec2 \
\cf4 \cb10 \strokec4 FROM\cf2 \strokec2  business\cb1 \
\cf4 \cb10 \strokec4 WHERE\cf2 \strokec2  city \cf11 \strokec11 =\cf2 \strokec2  \cf12 \strokec12 'Beachwood'\cf2 \cb1 \strokec2 \
\cf4 \cb10 \strokec4 GROUP\cf2 \strokec2  \cf4 \strokec4 BY\cf2 \strokec2  stars;\cb1 \
\pard\pardeftab720\sl360\partightenfactor0
\cf2 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \
\pard\pardeftab720\partightenfactor0

\f1 \cf2 \
Copy and Paste the Resulting Table Below (2 columns - star rating and count):	\
\pard\pardeftab720\partightenfactor0

\f3\fs28 \cf8 \cb9 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec8 +-------------+-------+\
| star rating | count |\
+-------------+-------+\
|         2.0 |     1 |\
|         2.5 |     1 |\
|         3.0 |     2 |\
|         3.5 |     2 |\
|         4.0 |     1 |\
|         4.5 |     2 |\
|         5.0 |     5 |\
+-------------+-------+\cf8 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf3 \cb1 \
7. Find the top 3 users based on their total number of reviews:\cf2 \
		\
SQL code used to arrive at answer:\
\pard\pardeftab720\partightenfactor0

\f2 \cf4 \cb5 SELECT\cf2  \cf4 name\cf2 , review_count\cb1 \
\pard\pardeftab720\sl360\partightenfactor0
\cf4 \cb5 FROM\cf2  \cf4 user\cf2 \cb1 \
\cf4 \cb5 ORDER\cf2  \cf4 BY\cf2  review_count\cb1 \
\cf4 \cb5 LIMIT\cf2  \cf13 3\cf2 ;\cb1 \
\pard\pardeftab720\partightenfactor0

\f1 \cf2 		\
Copy and Paste the Result Below:		\
\pard\pardeftab720\partightenfactor0

\f3\fs28 \cf8 \cb9 +--------+--------------+\
| name   | review_count |\
+--------+--------------+\
| Gerald |         2000 |\
| Sara   |         1629 |\
| Yuri   |         1339 |\
+--------+--------------+
\f1\fs24 \cf2 \cb1 \
\pard\pardeftab720\partightenfactor0
\cf3 8. Does posing more reviews correlate with more fans?\
\
Please explain your findings and interpretation of the results:\
\
\pard\pardeftab720\partightenfactor0
\cf14 Yes. Posing more reviews seem to correlate with more fans. Most of people appear in the table below have written lots of reviews on Yelp.\cf3 \
\
\pard\pardeftab720\partightenfactor0
\cf2 \
	\
SQL CODE:\
\pard\pardeftab720\sl360\partightenfactor0

\f2 \cf4 \cb5 SELECT\cf2  \cf4 name\cf2 , review_count, fans\cb1 \
\cf4 \cb5 FROM\cf2  \cf4 user\cf2 \cb1 \
\cf4 \cb5 ORDER\cf2  \cf4 BY\cf2  fans \cf4 DESC\cf2 ;\
\cb1 \
\pard\pardeftab720\partightenfactor0

\f1 \cf2 Result:\
\pard\pardeftab720\partightenfactor0

\f3\fs28 \cf8 \cb9 +-----------+--------------+------+\
| name      | review_count | fans |\
+-----------+--------------+------+\
| Amy       |          609 |  503 |\
| Mimi      |          968 |  497 |\
| Harald    |         1153 |  311 |\
| Gerald    |         2000 |  253 |\
| Christine |          930 |  173 |\
| Lisa      |          813 |  159 |\
| Cat       |          377 |  133 |\
| William   |         1215 |  126 |\
| Fran      |          862 |  124 |\
| Lissa     |          834 |  120 |\
| Mark      |          861 |  115 |\
| Tiffany   |          408 |  111 |\
| bernice   |          255 |  105 |\
| Roanna    |         1039 |  104 |\
| Angela    |          694 |  101 |\
| .Hon      |         1246 |  101 |\
| Ben       |          307 |   96 |\
| Linda     |          584 |   89 |\
| Christina |          842 |   85 |\
| Jessica   |          220 |   84 |\
| Greg      |          408 |   81 |\
| Nieves    |          178 |   80 |\
| Sui       |          754 |   78 |\
| Yuri      |         1339 |   76 |\
| Nicole    |          161 |   73 |\
+-----------+--------------+------+\
(Output limit exceeded, 25 of 10000 total rows shown)\
\pard\pardeftab720\partightenfactor0

\f1\fs24 \cf2 \cb1 	\
\cf3 9. Are there more reviews with the word "love" or with the word "hate" in them?\cf2 \
\
Answer: Yes\
\
	\
SQL code used to arrive at answer:\
\pard\pardeftab720\sl360\partightenfactor0

\f2 \cf4 \cb5 SELECT\cf2 (\cb1 \
\cb5     \cf4 SELECT\cf2  \cf7 COUNT\cf2 (\cf6 *\cf2 )\cb1 \
\cb5     \cf4 FROM\cf2  review\cb1 \
\cb5     \cf4 WHERE\cf2  \cf4 text\cf2  \cf6 LIKE\cf2  \cf12 '%love%'\cf2 ) \cf4 AS\cf2  love\cb1 \
\cb5     ,(\cf4 SELECT\cf2  \cf7 COUNT\cf2 (\cf6 *\cf2 )\cb1 \
\cb5     \cf4 FROM\cf2  review\cb1 \
\cb5     \cf4 WHERE\cf2  \cf4 text\cf2  \cf6 LIKE\cf2  \cf12 '%hate%'\cf2 ) \cf4 AS\cf2  hate;\
\
Result:\cb1 \
\pard\pardeftab720\partightenfactor0

\f3\fs28 \cf8 \cb9 +------+------+\
| love | hate |\
+------+------+\
| 1780 |  232 |\
+------+------+
\f1\fs24 \cf2 \cb1 	\
	\
\pard\pardeftab720\partightenfactor0
\cf3 10. Find the top 10 users with the most fans:\cf2 \
\
SQL code used to arrive at answer:\
\pard\pardeftab720\sl360\partightenfactor0

\f2 \cf4 \cb5 SELECT\cf2  \cf4 name\cf2 , fans\cb1 \
\cf4 \cb5 FROM\cf2  \cf4 user\cf2 \cb1 \
\cf4 \cb5 ORDER\cf2  \cf4 BY\cf2  fans \cf4 DESC\cf2 \cb1 \
\cf4 \cb5 LIMIT\cf2  \cf13 10
\f1 \cf2 \cb1 ;	\
\pard\pardeftab720\partightenfactor0
\cf2 	\
Copy and Paste the Result Below:\
\pard\pardeftab720\partightenfactor0

\f3\fs28 \cf8 \cb9 +-----------+------+\
| name      | fans |\
+-----------+------+\
| Amy       |  503 |\
| Mimi      |  497 |\
| Harald    |  311 |\
| Gerald    |  253 |\
| Christine |  173 |\
| Lisa      |  159 |\
| Cat       |  133 |\
| William   |  126 |\
| Fran      |  124 |\
| Lissa     |  120 |\
+-----------+------+
\f1\fs24 \cf2 \cb1 	\
		\
\
\pard\pardeftab720\partightenfactor0

\f0\b \cf2 Part 2: Inferences and Analysis
\f1\b0 \
\
\cf3 1. Pick one city and category of your choice and group the businesses in that city or category by their overall star rating. Compare the businesses with 2-3 stars to the businesses with 4-5 stars and answer the following questions. Include your code.\cf2 \
\
The city I pick is Toronto, and the category I pick is restaurants.\
	\
i. Do the two groups you chose to analyze have a different distribution of hours?\
\
This is no obvious difference between restaurants with higher ratings and those of lower ratings in terms of hours. 99 Cent Sushi and Sushi Osaka both opens st 11:00 and closes at 23:00 on Saturday. However, the former has the lowest star rating of 2.0, while the latter enjoys the highest rating of 4.5.\
\
ii. Do the two groups you chose to analyze have a different number of reviews?\
\
No. Number of reviews is not necessarily correlated to star rating.        \
         \
iii. Are you able to infer anything from the location data provided between these two groups? Explain.\
\
The location data cannot provide us with information about restaurants . Restaurants with 2-3 stars and Edulis (with 4 stars) are located in the same area.Reviews they received and opening hours also do not seem to be related to locations.\
\
SQL code used for analysis:\
\pard\pardeftab720\sl360\partightenfactor0

\f2 \cf4 \cb5 SELECT\cf2  b.\cf4 name\cf2 , b.city, c.category, b.stars, h.\cf4 hours\cf2 , b.review_count, b.\cf4 address\cf2 , b.postal_code\cb1 \
\cf4 \cb5 FROM\cf2  (business b \cf6 INNER\cf2  \cf6 JOIN\cf2  category c \cf4 ON\cf2  b.id \cf6 =\cf2  c.business_id) \cf6 INNER\cf2  \cf6 JOIN\cf2  \cf4 hours\cf2  h \cf4 ON\cf2  b.id \cf6 =\cf2  h.business_id \cb1 \
\cf4 \cb5 WHERE\cf2  b.city \cf6 =\cf2  \cf12 'Toronto'\cf2  \cf6 AND\cf2  c.category \cf6 =\cf2  \cf12 'Restaurants'\cf2 \cb1 \
\cf4 \cb5 GROUP\cf2  \cf4 BY\cf2  b.stars;
\f1 \cb1 	\
\
Result:\
\pard\pardeftab720\partightenfactor0

\f3\fs28 \cf8 \cb9 +---------------+---------+-------------+-------+----------------------+--------------+-----------------------+-------------+\
| name          | city    | category    | stars | hours                | review_count | address               | postal_code |\
+---------------+---------+-------------+-------+----------------------+--------------+-----------------------+-------------+\
| 99 Cent Sushi | Toronto | Restaurants |   2.0 | Saturday|11:00-23:00 |            5 | 389 Church Street     | M5B 2E5     |\
| Pizzaiolo     | Toronto | Restaurants |   3.0 | Saturday|10:00-4:00  |           34 | 270 Adelaide Street W | M5H 1X6     |\
| Edulis        | Toronto | Restaurants |   4.0 | Saturday|18:00-23:00 |           89 | 169 Niagara Street    | M5V         |\
| Sushi Osaka   | Toronto | Restaurants |   4.5 | Saturday|11:00-23:00 |            8 | 5084 Dundas Street W  | M9A 1C2     |\
+---------------+---------+-------------+-------+----------------------+--------------+-----------------------+-------------+
\f1\fs24 \cf2 \cb1 \
		\
\pard\pardeftab720\partightenfactor0
\cf3 2. Group business based on the ones that are open and the ones that are closed. What differences can you find between the ones that are still open and the ones that are closed? List at least two differences and the SQL code you used to arrive at your answer.\cf2 \
		\
i. Difference 1:\
   The business that are still running have more reviews on average than those that are currently closed.\
    \
         \
ii. Difference 2:\
    Those who are open have higher ratings in overall compared to those that are closed.\
             \
      \
         \
SQL code used for analysis:\
\pard\pardeftab720\sl360\partightenfactor0

\f2 \cf4 \cb5 SELECT\cf2  b.is_open, \cf7 COUNT\cf2 (\cf4 DISTINCT\cf2  b.id), \cf7 AVG\cf2 (b.stars), \cf7 AVG\cf2 (b.review_count), \cf7 COUNT\cf2 (r.useful), \cf7 COUNT\cf2 (r.funny), \cf7 COUNT\cf2 (r.cool)\cb1 \
\cf4 \cb5 FROM\cf2  business b \cf6 INNER\cf2  \cf6 JOIN\cf2  review r \cf4 ON\cf2  b.id \cf6 =\cf2  r.id\cb1 \
\cf4 \cb5 GROUP\cf2  \cf4 BY\cf2  b.is_open;\
\
Result:\cb1 \
\pard\pardeftab720\partightenfactor0

\f3\fs28 \cf8 \cb9 +---------+----------------------+---------------+---------------------+-----------------+----------------+---------------+\
| is_open | COUNT(DISTINCT b.id) |  AVG(b.stars) | AVG(b.review_count) | COUNT(r.useful) | COUNT(r.funny) | COUNT(r.cool) |\
+---------+----------------------+---------------+---------------------+-----------------+----------------+---------------+\
|       0 |                    1 |           2.0 |                 4.0 |               1 |              1 |             1 |\
|       1 |                   13 | 2.96153846154 |       38.7692307692 |              13 |             13 |            13 |\
+---------+----------------------+---------------+---------------------+-----------------+----------------+---------------+
\f1\fs24 \cf2 \cb1 	\
	\
\pard\pardeftab720\partightenfactor0
\cf3 3. For this last part of your analysis, you are going to choose the type of analysis you want to conduct on the Yelp dataset and are going to prepare the data for analysis.\cf2 \
\
Ideas for analysis include: Parsing out keywords and business attributes for sentiment analysis, clustering businesses to find commonalities or anomalies between them, predicting the overall star rating for a business, predicting the number of fans a user will have, and so on. These are just a few examples to get you started, so feel free to be creative and come up with your own problem you want to solve. Provide answers, in-line, to all of the following:\
	\
i. Indicate the type of analysis you chose to do:\
   I want to find business attributes that matter to restaurants.      \
         \
ii. Write 1-2 brief paragraphs on the type of data you will need for your analysis and why you chose that data:\
   Restaurants are places that serve customers with food, but food is not the only factor that attracts consumers. Since customers rate restaurants on Yelp to review services they receive, we can analyse the relationship between stars and business attributes at the restaurant level to get some insights into this question.                   \
                  \
iii. Output of your finished dataset:\
\pard\pardeftab720\partightenfactor0

\f3\fs28 \cf8 \cb9 +----------------------------+---------------+\
| service                    |  AVG(b.stars) |\
+----------------------------+---------------+\
| BestNights                 | 3.66666666667 |\
| CoatCheck                  | 3.66666666667 |\
| DogsAllowed                | 3.66666666667 |\
| GoodForDancing             | 3.66666666667 |\
| HappyHour                  | 3.66666666667 |\
| Smoking                    | 3.66666666667 |\
| WiFi                       | 3.36363636364 |\
| Caters                     | 3.34210526316 |\
| Ambience                   |           3.3 |\
| BusinessParking            | 3.27777777778 |\
| Alcohol                    | 3.26923076923 |\
| WheelchairAccessible       | 3.26923076923 |\
| RestaurantsTableService    |          3.26 |\
| HasTV                      | 3.25925925926 |\
| Music                      |          3.25 |\
| NoiseLevel                 | 3.24074074074 |\
| BikeParking                |         3.225 |\
| DriveThru                  | 3.21428571429 |\
| GoodForKids                | 3.21428571429 |\
| RestaurantsReservations    | 3.20689655172 |\
| GoodForMeal                |  3.2037037037 |\
| RestaurantsAttire          | 3.18965517241 |\
| RestaurantsPriceRange2     | 3.18333333333 |\
| BusinessAcceptsCreditCards | 3.16666666667 |\
| OutdoorSeating             | 3.15517241379 |\
+----------------------------+---------------+\
(Output limit exceeded, 25 of 28 total rows shown)
\f1\fs24 \cf2 \cb1          \
         \
iv. Provide the SQL code you used to create your final dataset:\
\
\pard\pardeftab720\sl360\partightenfactor0

\f2 \cf4 \cb5 SELECT\cf2  \cf4 DISTINCT\cf2  a.\cf4 name\cf2  \cf4 as\cf2  quality, \cf7 COUNT\cf2 (a.\cf4 name\cf2 ) \cf4 AS\cf2  frequency, \cf7 AVG\cf2 (\cf4 value\cf2 )\cb1 \
\cf4 \cb5 FROM\cf2  attribute a \cf6 INNER\cf2  \cf6 JOIN\cf2  business b \cf4 ON\cf2  a.business_id \cf6 =\cf2  b.id\cb1 \
\cf4 \cb5 GROUP\cf2  \cf4 BY\cf2  quality\cb1 \
\cf4 \cb5 ORDER\cf2  \cf4 BY\cf2  frequency \cf4 DESC\cf2 , \cf7 AVG\cf2 (\cf4 value\cf2 ) \cf4 DESC\cf2 ;\cb1 \
}